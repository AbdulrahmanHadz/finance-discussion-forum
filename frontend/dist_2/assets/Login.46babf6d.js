import{_ as y,p as k,s as x,r as a,o as n,d as i,a as u,f as d,h as c,b as p,c as _,w as M,i as v,j as w}from"./index.51d15672.js";import{U as B,P as S,R as V}from"./rememberme.699f005e.js";import{S as E,c as b,v as F}from"./SubmitButton.4666d5fc.js";import{g as q}from"./goToPrevious.cf24a95f.js";const D={data(){return{form:{username:null,password:null},required:{username:{min:3,max:100},password:{min:5,max:72}},successMessage:null,errorMessage:null,buttonDisabled:!0,buttonKey:0}},components:{UsernameField:B,PasswordField:S,SubmitButton:E,RememberCheckbox:V},methods:{onSubmit(m){console.log(this.form);const s=b(Object.keys(this.form),Object.keys(this.required));this.errorMessage=s,!s&&k("users/login",this.form).then(o=>{console.log(o);const e=o.data.data.id;x(e,this.form.username),this.successMessage="Logged In.",setTimeout(()=>{this.successMessage=null,this.errorMessage=null,q(this.$router)},2e3)}).catch(o=>{console.log(o);const e=o.response.data;"message"in e&&(this.errorMessage=e.message)})},validate(m){if(b(this.form,Object.keys(this.required))){this.buttonDisabled=!0,this.rerenderButton();return}this.errorMessage=null;const o=F(this.form,this.required);if(console.log(o),o){this.errorMessage=o,this.buttonDisabled=!0,this.rerenderButton();return}console.log(this.form),this.buttonDisabled=!1,this.rerenderButton()},rerenderButton(){this.buttonKey++}}},U={class:"stack full-container"},C={class:"mb-5 p-3 font-bold text-lg"},j={key:0,class:"success"},I={key:1,class:"error"};function L(m,s,o,l,e,t){const f=a("UsernameField"),g=a("PasswordField"),h=a("SubmitButton");return n(),i("div",U,[u("div",C,[e.successMessage!=null?(n(),i("h4",j,d(e.successMessage),1)):c("",!0),e.errorMessage!=null?(n(),i("p",I,d(e.errorMessage),1)):c("",!0)]),u("form",{class:"stack",id:"myForm",onSubmit:s[2]||(s[2]=v((...r)=>t.onSubmit&&t.onSubmit(...r),["prevent"])),onInput:s[3]||(s[3]=(...r)=>t.validate&&t.validate(...r)),novalidate:"novalidate"},[p(f,{label:"Username or Email",modelValue:e.form.username,"onUpdate:modelValue":s[0]||(s[0]=r=>e.form.username=r),modelModifiers:{trim:!0},min:e.required.username.min,max:e.required.username.max},null,8,["modelValue","min","max"]),p(g,{modelValue:e.form.password,"onUpdate:modelValue":s[1]||(s[1]=r=>e.form.password=r),min:e.required.password.min,max:e.required.password.max},null,8,["modelValue","min","max"]),(n(),_(h,{key:e.buttonKey,disabled:e.buttonDisabled,onClick:t.onSubmit},{submit:M(()=>[w(" Login ")]),_:1},8,["disabled","onClick"]))],32)])}const O=y(D,[["render",L]]);export{O as default};
